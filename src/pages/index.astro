---
// Component Imports
import BaseHead from '../components/BaseHead.astro';
import BlogHeader from '../components/BlogHeader.astro';
import BlogPostPreview from '../components/BlogPostPreview.astro';
import CategoryPreview from '../components/CategoryPreview.astro';
import { SITE } from '../config';
import Layout from '../layouts/Layout.astro';

// Component Script:
// You can write any JavaScript/TypeScript that you'd like here.
// It will run during the build, but never in the browser.
// All variables are available to use in the HTML template below.
let { title } = SITE;
let description = 'Химеры -.';
let permalink = 'https://nickgolitsyn.com/';

// Data Fetching: List all Markdown posts in the repo.
let categoryPosts = await Astro.glob('./categories/*.md');
// categoryPosts = categoryPosts.sort((a, b) => new Date(b.frontmatter.publishDate).valueOf() - new Date(a.frontmatter.publishDate).valueOf());


let allPosts = await Astro.glob('./posts/*.md');
allPosts = allPosts.sort((a, b) => new Date(b.frontmatter.publishDate).valueOf() - new Date(a.frontmatter.publishDate).valueOf());

// Full Astro Component Syntax:
// https://docs.astro.build/core-concepts/astro-components/
---
<Layout {title} {description} {permalink}>
	<main class="content">
    <section>
      <img width="720" height="420" class="hero-image mx-auto my-8" loading="lazy" src='/assets/cover.jpg' />
    </section>
		<!-- <section class="intro">
			<h1 class="latest">{title}</h1>
			<p>{description}</p>
		</section> -->
    <section aria-label="Blog post list">
			{categoryPosts.map((p) => <CategoryPreview post={p} allPosts={allPosts} />)}
		</section>
		<!-- <section aria-label="Blog post list">
			{allPosts.map((p) => <BlogPostPreview post={p} />)}
		</section> -->
	</main>
</Layout>

<style>
	header {
    width: 100%;
    height: 100%;
    /* background-color: var(--theme-bg-offset); */
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .hero-image {
		width: 70vw;
		aspect-ratio: 2/1;
		object-fit: cover;
		object-position: center;
		margin-top: 2rem;
		margin-bottom: 4rem;
		max-width: 1280px;
	}

	@media (max-width: 50em) {
		.hero-image {
			height: 260px;
			margin-top: 0;
			margin-bottom: 2rem;
		}
	}

  .content {
    margin-top: 4rem;
    margin-bottom: 8rem;
  }

  .content :global(main > * + *) {
    margin-top: 1rem;
  }

  .intro {
    padding-bottom: 4rem;
    margin-bottom: 2rem;
    border-bottom: 4px solid var(--theme-divider);
  }

  .intro > * {
    margin: 0;
  }

  .latest {
    font-size: 2.5rem;
    font-weight: 700;
  }

  footer {
    text-align: center;
  }
</style>
